groups:
- name: on_premises
  rules:
  - alert: Under-voltage detected
    expr: 'count_over_time({filename="/var/log/messages"} |~ "Under-voltage detected"[10m]) > 0'
    for: 5m
    labels:
        severity: warn
    annotations:
        summary: "Instance {{ $labels.node }} Under-voltage detected"
  - alert: Under-voltage detected
    expr: 'count_over_time({filename="/var/log/syslog"} |~ "Under-voltage detected"[10m]) > 0'
    for: 5m
    labels:
        severity: warn
    annotations:
        summary: "Instance {{ $labels.node }} Under-voltage detected"
  - alert: I/O error
    expr: 'count_over_time({filename="/var/log/messages"} |~ "I/O error"[10m]) > 0'
    for: 5m
    labels:
        severity: alert
    annotations:
        summary: "Instance {{ $labels.node }} I/O error"
  - alert: I/O error
    expr: 'count_over_time({filename="/var/log/syslog"} |~ "I/O error"[10m]) > 0'
    for: 5m
    labels:
        severity: alert
    annotations:
        summary: "Instance {{ $labels.node }} I/O error"
  - alert: Kernel error
    expr: 'count_over_time({filename="/var/log/kern.log"} |~ "Error|error"[10m]) > 0'
    for: 5m
    labels:
        severity: alert
    annotations:
        summary: "Instance {{ $labels.node }} Kernel error"
  - alert: Kernel error
    expr: 'count_over_time({filename="/var/log/dmesg"} |~ "Error|error"[10m]) > 0'
    for: 5m
    labels:
        severity: alert
    annotations:
        summary: "Instance {{ $labels.node }} Kernel error"
  - alert: minecraft bedrock server user connected
    expr: 'count_over_time({namespace="prod-minecraft"}|~ "Player connected"[10m]) > 0'
    for: 5m
    labels:
        severity: info
    annotations:
        summary: "Minecraft bedrock server user connected"
  - alert: longhorn buckup error
    expr: 'count_over_time({namespace="longhorn-system"} |= "cannot mount nfs"[1m]) > 0'
    for: 5m
    labels:
        severity: alert
    annotations:
        summary: "longhorn-system {{ $labels.node }} cannot mount nfs"
  - alert: "Remote Storage error"
    expr: 'count_over_time({app_kubernetes_io_name="prometheus"} |~ `level=error` |~ `component=remote` |~ `msg="non-recoverable error"`[5m]) > 0'
    for: 5m
    labels:
      severity: alert
    annotations:
      summary: "prometheus remote write error"
